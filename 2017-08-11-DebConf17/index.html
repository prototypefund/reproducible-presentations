<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Reproducible Builds Status Update</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

  <link rel="stylesheet" href="css/reveal.css">
  <link rel="stylesheet" href="css/theme/black.css" id="theme">

  <style type="text/css">
  * {
    text-transform: none !important;
  }
  li {
    margin-top: 28px !important;
    list-style-type: none !important;
  }
  ul ul li {
    margin-top: 16px !important;
  }
  a {
    color: inherit !important;
  }

  .text-center {
    text-align: center;
  }

  .text-left {
    text-align: left;
  }

  .text-right {
    text-align: right;
  }

  .pull-left {
    float: left;
  }

  .pull-right {
    float: right;
  }

  .reveal pre code {
    padding: 20px;
    overflow: hidden;
    background-color: #3f3f3f;
  }
  </style>

  <!--[if lt IE 9]>
  <script src="lib/js/html5shiv.js"></script>
  <![endif]-->
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <section data-background="images/debian_logo.png" data-background-size="7%" data-background-position="50% 20%">
        <h1 style="margin: 250px 0 120px 0; font-size: 140%;">Reproducible Builds<br>Status Update</h1>
        <h2 class="pull-left text-left" style="font-size: 80%">
          Chris Lamb &bull; Holger Levsen &bull; Maria Glukhova<br>
          Vagrant Cascadian &bull; Valerie Young &bull; Ximin Luo
        </h2>
        <h2 class="pull-right text-right" style="font-size: 80%">
          DebConf17
          <br>
          Montr√©al, Canada
        </h2>
      </section>

      <section>
        <h3>Quick Introduction to R-B concept</h3>
      </section>

      <section>
        <h3>Examples</h3>
        <ul>
          <li>Examples of attacks</li>
        </ul>
      </section>

      <section>
        <h3>QA benefits</h3>
        <ul>
          <li>Examples of QA issues caught (from lamby's slides)</li>
        </ul>
      </section>

      <section>
        <h3>Predictable OpenID secret</h3>

<pre class="fragment"><code># Build.PL
$build-&gt;config_data(OpenIDConsumerSecret=&gt;int(1e15*rand()));
</code></pre>

<pre class="fragment"><code># /usr/share/perl5/GBrowse/ConfigData.pm
{
 'OpenIDConsumerSecret' =&gt; '639098210478536',
 'cgibin' =&gt; '/usr/lib/cgi-bin/gbrowse',
 'conf' =&gt; '/etc/gbrowse',
 [..]
},
</code></pre>

        <ul>
          <li class="fragment">Every installation of shares the same secret.</li>
        </ul>

        <p class="fragment">
          <a href="https://bugs.debian.org/833885">#833885 (gbrowse)</a>
        </p>
      </section>

      <section>
        <h3>Random chars in manpages</h3>

        <ul>
          <li class="fragment">Randomly inserts characters into generated manpages</li>
        </ul>

        <pre class="fragment"><code>-This manual page documents the usageoof WikipediaFS.
+This manual page documents the usage of WikipediaFS.
</code></pre>

        <pre class="fragment"><code>memcpy(&amp;buf[1], &amp;buf[2], strlen(buf)-1);</code></pre>

        <ul>
          <li class="fragment">"<code> n\\011</code>" &rarr; "<code>\111</code>" &rarr; maps to capital "I"</li>
        </ul>

        <pre class="fragment"><code>- memcpy(&amp;buf[1], &amp;buf[2], strlen(buf)-1);
+ memmove(&amp;buf[1], &amp;buf[2], strlen(buf)-1);
</code></pre>

        <p class="bug-link fragment">
          <a href="https://bugs.debian.org/842635">#842635 (docbook2man)</a>
        </p>
      </section>

      <section>
        <h3>Fails to build 0.46% of the time</h3>

<pre class="fragment"><code>x = f(u('abc'), 16)
y = f(u('abc'), 16)
self.assertEqual(sorted(set(x)), [u('a'),u('b'),u('c')])
</code></pre>

<pre class="fragment"><code>AssertionError: Lists differ: [u'a', u'b'] != [u'a', u'b', u'c']</code></pre>

        <ul>
          <li class="fragment">
            (3C2)*(2/3)^16 &ndash; (3C1)*(1/3)^16 =~ 0.46%
          </li>
        </ul>

        <p class="fragment" style="margin-top: 1em;">
          <a href="https://bugs.debian.org/844233">#844233 (python-passlib)</a>
        </p>
      </section>

      <!-- ----------------------------------------------------------------- -->


      <section>
        <h3>How far we've come..!</h3>
        <table>
          <tr><td>First rebuild in 2013</td><td>24% packages reproducible</td></tr>
          <tr><td>August 2017</td><td>88% packages reproducible</td></tr>
        </table>		
      </section>


      <section>
        <h3>Check the progress</h3>
        <h2>tests.reproducible-builds.org</h2>		
      </section>

      <section>
        <h2>Recent updates</h2>
      </section>

      <section>
        <h3>Reproducible Builds Summit</h3>
        <h3>December 2016, Berlin</h3>
		<h4>Who Attended?</h4>
      </section>

      <section data-background-color="white">
        <img src="images/who/archlinux.png">
        <img src="images/who/coreboot.png">
        <img src="images/who/electrobsd.png">
        <img src="images/who/f-droid.png">
        <img src="images/who/freebsd.png">
        <img src="images/who/fedora.png">
        <img src="images/who/guix.png">
        <img src="images/who/lede.png">
        <img src="images/who/netbsd.png">
        <img src="images/who/nixos.png">
        <img src="images/who/openSUSE.png">
        <img src="images/who/openwrt.png">
        <img src="images/who/tails.png">
        <img src="images/who/tor.png">
		<ul>
		<li>Software Freedom Conservancy<li>
		<li>Bazel<li>
		</ul>
      </section>



      <section>
        <h3>reproducible-builds.org/docs/definition</h3>
A build is <b>reproducible</b> if given the same <i>source code</i>, <i>build environment and build instructions</i>, any party can recreate bit-by-bit identical copies of all specified <i>artifacts</i>.
<div>...</div>
      </section>

      <section>
        <h3>Reproducible Builds Summit 2016</h3>
		<h4>Other work?</h4>
		<ul>
		<li>.buildinfo files for RPMs<li>
		<li>Cross Distro Collaboration<li>
		</ul>
      </section>

      <section>
        <h3>tests.r-b.org expansion</h3>
        <ul>
          <li>added arm64</li>
          <li>expanded armhf, up to 29 boards!</li>
          <li>some arm64 boards building armhf, with <em>issues</em></li>
        </ul>
      </section>

      <section>
        <h3>updates on buildpath</h3>
        <ul>
          <li>golang, rustc updates</li>
          <li>gcc patch getting some resistance, might have to change approach</li>
        </ul>
      </section>

      <section>
        <h3>OpenSuSE on board</h3>
        <ul>
          <li>bernhard submitting a lot of patches upstream, pick some examples</li>
        </ul>
      </section>

      <!-- ----------------------------------------------------------------- -->

      <section>
        <h2>Reproducibility tools</h2>
      </section>

      <section>
        <h3>reprotest - overview and updates</h3>
        <ul>
          <li>What: run commands and check their output for reproducibility. Features:
          <ul>
            <li>Various virtual environments (e.g. ...)</li>
            <li>Presets for convenience, atm only Deb packages</li>
          </ul></li>
          <li>Reduce diff with autopkgtest, aim to deduplicate (ximin)</li>
          <li>Make it distro-independent, first ArchLinux (sanjev)</li>
        </ul>
      </section>
      
      <section>
        <h3>diffoscope - overview</h3>
        <ul>
          <li>What exactly makes two files different?</li>
          <li>Recursively unpacks archives, uncompresses PDF files, disassembles binaries etc.</li>
          <li>Converts various file formats to human-readable form.</li>
          <li>Reports differences in form of plain text, HTML, RST, JSON or Markdown.</li>
        </ul>
      </section>
      
      <section>
        <h3>diffoscope - updates 1/2</h3>
        <ul>
          <li>Save json output, can be read back in. (ximin)</li>
          <li>Rewrite html-dir output to support huge diffs, e.g. GCC.</li>
          <li>10s of speed optimisations (lamby, via Tails)</li>
          <li>--exclude, --max-container-depth and other ways to control behavior</li>
        </ul>
      </section>
      
      <section>
        <h3>diffoscope - updates 2/2</h3>
        <ul>
          <li>New formats supported for comparison: OGG, .dtb, R object files (.rds, .rdb), PGP files, .docx, .odt, ...</li>
          <li>New output formats: RST, Markdown, JSON</li>
          <li>Visual comparison of images (JPEG, ICO, PNG, GIF)</li>
        </ul>
      </section>

      <!-- ----------------------------------------------------------------- -->

      <section>
        <h2>Future directions</h2>
      </section>

      <section>
        <h3>stretch released, focusing on buster now</h3>
        <ul>
          <li>plans for NMU campaign, decided not started</li>
          <li>"required" packages NMU (by ximin), now everything there is reproducible except GCC</li>
        </ul>
      </section>

      <section>
        <h3>dak and Debian archive</h3>
        <ul>
          <li>publish buildinfo files</li>
          <li>tests.r-b.org: perhaps run rebuilds against actual debian binaries (mention steven's talk)</li>
        </ul>
      </section>

      <section>
        <h3>Policy and UI</h3>
        <ul>
          <li>policy, to encourage people to make their packages reproducible (#844431)</li>
          <li>apt UI, notify users about unreproducible stuff (#863622)</li>
          <li>(and maybe other issues like security bugs)</li>
        </ul>
      </section>

      <section>
        <h3>How you can help?</h3>
        <ul>
          <li>tests.reproducible.org</li>
          <li>(TODO, take stuff from above)</li>
        </ul>
      </section>

      <section data-background-image="images/debian.jpg">
        <h4 class="pull-left text-left" style="font-size: 60%;" >
          #debian-reproducible (OFTC)<br>
          reproducible-builds@lists.alioth.debian.org
        </h4>
        <h4 class="pull-right text-right" style="font-size: 60%;">
          #reproducible-builds (OFTC)
          <br>
          reproducible-builds.org
        </h4>
      </section>
    </div>
  </div>

  <script src="lib/js/head.min.js"></script>
  <script src="js/reveal.js"></script>
  <script>
    Reveal.initialize({
      controls: false,
      progress: false,
      history: true,
      keyboard: {
        13: 'next',
        38: 'next',
         9: 'prev',
        40: 'prev'
      }
    });
  </script>
</body>
</html>
